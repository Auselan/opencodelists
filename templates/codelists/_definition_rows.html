{% load definitions %}

<ul>
  {% for row in rows %}
  <li>
    <a href="{% concept_url codelist.coding_system_id row.code %}" style="color: blue">
      {{ row.name }}
    </a>
    (<code>{{ row.code }}</code>)

    {% if row.all_descendants %}
    and all descendants {% if row.excluded_descendants %} except:{% endif %}
    {% endif %}

    {% if row.excluded_descendants %}
    <ul class="mb-0">

      {% for child in row.excluded_descendants %}
      <li>
        <a href="{% concept_url codelist.coding_system_id child.code %}" style="color: black">
          {{ child.name }}
        </a>
        (<code>{{ child.code }}</code>)
      </li>
      {% endfor %}

    </ul>

    {% endif %}
  </li>

  {% endfor %}
</ul>
